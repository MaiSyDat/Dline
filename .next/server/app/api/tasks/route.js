"use strict";(()=>{var e={};e.id=495,e.ids=[495],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3552:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>h,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var r={};n.r(r),n.d(r,{GET:()=>l,POST:()=>p});var a=n(3278),o=n(5002),s=n(4877),i=n(1309),u=n(3670),c=n(7710);async function l(){let{tasks:e}=await (0,u.bG)(),t=await e.find().toArray();return i.NextResponse.json({ok:!0,data:t})}async function p(e){try{let{projectId:t,title:n,description:r="",assigneeId:a,startDate:o,deadline:s,status:l=c.hY.NEW,priority:p=c.T8.MEDIUM,imageUrls:d}=await e.json();if(!t||!n||!a||!s)return i.NextResponse.json({ok:!1,error:"Thiếu projectId/title/assigneeId/deadline"},{status:400});let m={id:crypto.randomUUID(),projectId:t,title:n,description:r,assigneeId:a,startDate:o||new Date().toISOString().split("T")[0],deadline:s,status:l,priority:p,createdAt:new Date().toISOString(),imageUrls:d},{tasks:f}=await (0,u.bG)();return await f.insertOne(m),i.NextResponse.json({ok:!0,data:m})}catch(t){let e=t instanceof Error?t.message:"Kh\xf4ng thể tạo c\xf4ng việc";return i.NextResponse.json({ok:!1,error:e},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/tasks/route",pathname:"/api/tasks",filename:"route",bundlePath:"app/api/tasks/route"},resolvedPagePath:"D:\\CODE\\NextJS\\d-line\\app\\api\\tasks\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:g}=d,h="/api/tasks/route";function w(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},3670:(e,t,n)=>{n.d(t,{SI:()=>p,bG:()=>d,pg:()=>m});let r=require("mongodb"),a=process.env.DATABASE_URL,o=process.env.MONGODB_DB||"dline",s=null,i=null,u=null;async function c(){if(!a)throw Error("DATABASE_URL chưa được cấu h\xecnh cho MongoDB.");return s||(s=new r.MongoClient(a).connect())}async function l(){return i||(i=(await c()).db(o))}async function p(){let e=await l(),t=["users","projects","tasks"],n=new Set((await e.listCollections().toArray()).map(e=>e.name));for(let r of t)n.has(r)||await e.createCollection(r);return t}async function d(){if(u)return u;let e=await l();return await p(),u={users:e.collection("users"),projects:e.collection("projects"),tasks:e.collection("tasks")}}async function m(){let e=await l();return await e.command({ping:1}),{ok:1,db:e.databaseName}}},7710:(e,t,n)=>{var r,a,o;n.d(t,{T8:()=>o,hY:()=>a,i4:()=>r}),function(e){e.ADMIN="admin",e.MANAGER="manager",e.EMPLOYEE="employee"}(r||(r={})),function(e){e.NEW="new",e.BUG="bug",e.IN_PROGRESS="in-progress",e.FIXED="fixed",e.DONE="done"}(a||(a={})),function(e){e.LOW="low",e.MEDIUM="medium",e.HIGH="high"}(o||(o={}))}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[787,833],()=>n(3552));module.exports=r})();