"use strict";(()=>{var e={};e.id=871,e.ids=[871],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3017:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{GET:()=>u,POST:()=>p});var a=r(3278),o=r(5002),s=r(4877),i=r(1309),c=r(3670);async function u(){let{projects:e}=await (0,c.bG)(),t=await e.find().toArray();return i.NextResponse.json({ok:!0,data:t})}async function p(e){try{let{name:t,description:r="",memberIds:n=[],status:a="active",startDate:o,deadline:s,color:u="#0F172A",managerId:p}=await e.json();if(!t||!o)return i.NextResponse.json({ok:!1,error:"Thiếu name hoặc startDate"},{status:400});let l={id:crypto.randomUUID(),name:t,description:r,memberIds:n,status:a,startDate:o,deadline:s,color:u,createdAt:new Date().toISOString(),managerId:p||n[0]||""},{projects:d}=await (0,c.bG)();return await d.insertOne(l),i.NextResponse.json({ok:!0,data:l})}catch(t){let e=t instanceof Error?t.message:"Kh\xf4ng thể tạo dự \xe1n";return i.NextResponse.json({ok:!1,error:e},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"D:\\CODE\\NextJS\\d-line\\app\\api\\projects\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:h}=l,w="/api/projects/route";function f(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},3670:(e,t,r)=>{r.d(t,{SI:()=>l,bG:()=>d,pg:()=>m});let n=require("mongodb"),a=process.env.DATABASE_URL,o=process.env.MONGODB_DB||"dline",s=null,i=null,c=null;async function u(){if(!a)throw Error("DATABASE_URL chưa được cấu h\xecnh cho MongoDB.");return s||(s=new n.MongoClient(a).connect())}async function p(){return i||(i=(await u()).db(o))}async function l(){let e=await p(),t=["users","projects","tasks"],r=new Set((await e.listCollections().toArray()).map(e=>e.name));for(let n of t)r.has(n)||await e.createCollection(n);return t}async function d(){if(c)return c;let e=await p();return await l(),c={users:e.collection("users"),projects:e.collection("projects"),tasks:e.collection("tasks")}}async function m(){let e=await p();return await e.command({ping:1}),{ok:1,db:e.databaseName}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[787,833],()=>r(3017));module.exports=n})();