"use strict";(()=>{var e={};e.id=701,e.ids=[701],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3691:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>w,patchFetch:()=>E,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var r={};n.r(r),n.d(r,{GET:()=>p,POST:()=>l});var a=n(3278),o=n(5002),s=n(4877),i=n(1309),u=n(3670),c=n(7710);async function p(){let{users:e}=await (0,u.bG)(),t=await e.find().toArray();return i.NextResponse.json({ok:!0,data:t})}async function l(e){try{let{name:t,email:n,password:r,role:a=c.i4.EMPLOYEE,avatar:o}=await e.json();if(!t||!n||!r)return i.NextResponse.json({ok:!1,error:"Thiếu name/email/password"},{status:400});let{users:s}=await (0,u.bG)();if(await s.findOne({email:n}))return i.NextResponse.json({ok:!1,error:"Email đ\xe3 tồn tại"},{status:400});let p={id:crypto.randomUUID(),name:t,email:n,password:r,role:a,avatar:o||`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=0F172A&color=fff`};return await s.insertOne(p),i.NextResponse.json({ok:!0,data:p})}catch(t){let e=t instanceof Error?t.message:"Kh\xf4ng thể tạo user";return i.NextResponse.json({ok:!1,error:e},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/users/route",pathname:"/api/users",filename:"route",bundlePath:"app/api/users/route"},resolvedPagePath:"D:\\CODE\\NextJS\\d-line\\app\\api\\users\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:h}=d,w="/api/users/route";function E(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},3670:(e,t,n)=>{n.d(t,{SI:()=>l,bG:()=>d,pg:()=>m});let r=require("mongodb"),a=process.env.DATABASE_URL,o=process.env.MONGODB_DB||"dline",s=null,i=null,u=null;async function c(){if(!a)throw Error("DATABASE_URL chưa được cấu h\xecnh cho MongoDB.");return s||(s=new r.MongoClient(a).connect())}async function p(){return i||(i=(await c()).db(o))}async function l(){let e=await p(),t=["users","projects","tasks"],n=new Set((await e.listCollections().toArray()).map(e=>e.name));for(let r of t)n.has(r)||await e.createCollection(r);return t}async function d(){if(u)return u;let e=await p();return await l(),u={users:e.collection("users"),projects:e.collection("projects"),tasks:e.collection("tasks")}}async function m(){let e=await p();return await e.command({ping:1}),{ok:1,db:e.databaseName}}},7710:(e,t,n)=>{var r,a,o;n.d(t,{T8:()=>o,hY:()=>a,i4:()=>r}),function(e){e.ADMIN="admin",e.MANAGER="manager",e.EMPLOYEE="employee"}(r||(r={})),function(e){e.NEW="new",e.BUG="bug",e.IN_PROGRESS="in-progress",e.FIXED="fixed",e.DONE="done"}(a||(a={})),function(e){e.LOW="low",e.MEDIUM="medium",e.HIGH="high"}(o||(o={}))}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[787,833],()=>n(3691));module.exports=r})();